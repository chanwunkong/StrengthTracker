<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>力量曲線互動圖</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>

<body>
    <h2>力量成長曲線 (按體重調整)</h2>
    <label for="genderSelect">選擇性別:</label>
    <select id="genderSelect" onchange="setDefaultWeight(); updateChart()">
        <option value="male">男性</option>
        <option value="female">女性</option>
    </select>

    <br><br>

    <label for="movementSelect">選擇動作:</label>
    <select id="movementSelect" onchange="updateChart()">
        <option value="Press">肩推 (Press)</option>
        <option value="Bench Press">臥推 (Bench Press)</option>
        <option value="Squat">深蹲 (Squat)</option>
        <option value="Deadlift">硬舉 (Deadlift)</option>
        <option value="Power Clean">抓舉 (Power Clean)</option>
    </select>

    <br><br>

    <label for="weightRange">選擇體重 (kg):</label>
    <input type="range" id="weightRange" name="weightRange" min="40" max="120" value="70" step="1"
        oninput="updateChart()">
    <span id="weightDisplay">70 kg</span>

    <div id="chart" style="width:100%;max-width:900px;height:600px;"></div>

    <script>
        // 所有動作的參數
        const movementParams = {
            "male": {
                "Press": { a: 0.1431, s: -0.00638, t_b: 1.1754, p: -10.0000, q: 0.00014, r: 0.5232 },
                "Bench Press": { a: 0.3139, s: -0.00264, t_b: 0.4839, p: -0.5423, q: 0.00819, r: 0.8852 },
                "Squat": { a: 0.5422, s: -0.00464, t_b: 0.8392, p: 0.0940, q: 1.0000, r: 0.2077 },
                "Deadlift": { a: 0.6162, s: -0.00451, t_b: 0.7939, p: -10.0000, q: 0.00021, r: 0.9278 },
                "Power Clean": { a: 0.2729, s: -0.00695, t_b: 1.2416, p: -0.8312, q: 0.00270, r: 0.6080 }
            },
            "female": {
                "Press": { a: 0.1814, s: 0, t_b: 0.1890, p: -9.9254, q: 0.0000313, r: 0.3351 },
                "Bench Press": { a: 0.1969, s: -0.00190, t_b: 0.3630, p: -0.9643, q: 0.00197, r: 0.5763 },
                "Squat": { a: 0.2910, s: -0.00321, t_b: 0.7077, p: -10.0000, q: 0.0000872, r: 0.5138 },
                "Deadlift": { a: 0.4580, s: -0.00380, t_b: 0.5739, p: -9.9499, q: 0.0001506, r: 0.6309 },
                "Power Clean": { a: 0.1987, s: -0.00584, t_b: 0.9348, p: -10.0000, q: 0.0000529, r: 0.3616 }
            }
        };



        function calculateAbsoluteStrength(t, w, params) {
            const ratio = params.a * Math.log((params.s * w + params.t_b) * t + 1) + (params.p * Math.log(params.q * w + 1) + params.r);
            return ratio * w; // 直接計算絕對重量
        }

        function setDefaultWeight() {
            const gender = document.getElementById('genderSelect').value;
            const weightRange = document.getElementById('weightRange');
            const weightDisplay = document.getElementById('weightDisplay');

            if (gender === 'male') {
                weightRange.value = 70;
                weightDisplay.innerText = '70 kg';
            } else {
                weightRange.value = 55;
                weightDisplay.innerText = '55 kg';
            }
        }

        function updateChart() {
            const gender = document.getElementById('genderSelect').value;
            const movement = document.getElementById('movementSelect').value;
            const params = movementParams[gender][movement];

            const weight = parseInt(document.getElementById('weightRange').value);
            document.getElementById('weightDisplay').innerText = weight + ' kg';

            let xData = [];
            let yData = [];

            for (let t = 0; t <= 120; t++) { // 0~10年 (120個月)
                xData.push(t);
                yData.push(calculateAbsoluteStrength(t, weight, params));
            }

            const trace = {
                x: xData,
                y: yData,
                type: 'scatter',
                mode: 'lines+markers',
                name: movement + ' 絕對力量 (kg)'
            };

            const layout = {
                title: '體重 ' + weight + ' kg 的 ' + getMovementName(movement) + ' 絕對力量成長曲線 (' + (gender === 'male' ? '男性' : '女性') + ')',
                xaxis: { title: '訓練時間（月）' },
                yaxis: { title: '絕對力量 (kg)' },
                shapes: [
                    { type: 'line', x0: 6, y0: 0, x1: 6, y1: Math.max(...yData), line: { color: 'red', dash: 'dot' } },
                    { type: 'line', x0: 12, y0: 0, x1: 12, y1: Math.max(...yData), line: { color: 'red', dash: 'dot' } },
                    { type: 'line', x0: 24, y0: 0, x1: 24, y1: Math.max(...yData), line: { color: 'red', dash: 'dot' } },
                    { type: 'line', x0: 48, y0: 0, x1: 48, y1: Math.max(...yData), line: { color: 'red', dash: 'dot' } }
                ],
                annotations: [
                    { x: 6, y: 0, text: '新手', showarrow: false, font: { color: 'red' }, yshift: -20 },
                    { x: 12, y: 0, text: '初學者', showarrow: false, font: { color: 'red' }, yshift: -20 },
                    { x: 24, y: 0, text: '中級', showarrow: false, font: { color: 'red' }, yshift: -20 },
                    { x: 48, y: 0, text: '高級', showarrow: false, font: { color: 'red' }, yshift: -20 }
                ]
            };

            Plotly.newPlot('chart', [trace], layout);
        }

        function getMovementName(movement) {
            const names = {
                'Press': '肩推 (Press)',
                'Bench Press': '臥推 (Bench Press)',
                'Squat': '深蹲 (Squat)',
                'Deadlift': '硬舉 (Deadlift)',
                'Power Clean': '抓舉 (Power Clean)'
            };
            return names[movement];
        }

        // 初始化圖表
        setDefaultWeight();
        updateChart();
    </script>

</body>

</html>